var J=(r,e,t)=>{if(!e.has(r))throw TypeError("Cannot "+t)};var a=(r,e,t)=>(J(r,e,"read from private field"),t?t.call(r):e.get(r)),y=(r,e,t)=>{if(e.has(r))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(r):e.set(r,t)},u=(r,e,t,s)=>(J(r,e,"write to private field"),s?s.call(r,t):e.set(r,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function t(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(n){if(n.ep)return;n.ep=!0;const i=t(n);fetch(n.href,i)}})();let ge=class{constructor(e,t,s){this.type=e,this.target=t,this.data=s}},we=class{constructor(e){this.eventHandler_ListenerStorage={},this.target=e}on(e,t){let s=this.eventHandler_ListenerStorage[e];return s?s.indexOf(t)==-1?s.push(t):console.warn("Subscriber already in handler"):this.eventHandler_ListenerStorage[e]=[t],t}once(e,t){return this.on(e,function(s){return t(s),!0}),t}off(e,t){let s=this.eventHandler_ListenerStorage[e];if(s){let n=s.indexOf(t);n!=-1?s.splice(n,1):console.warn("Subscriber not in handler")}return t}emit(e,t){let s=this.eventHandler_ListenerStorage[e];if(s&&s.length>0){let n=Object.freeze(new ge(e,this.target,t));s.length>1&&(s=[...s]);for(let i=0,o=s.length;i<o;i++)try{s[i](n)===!0&&(s.splice(i,1),o--,i--)}catch(c){console.warn("Failed while dispatching event",c)}}}clear(e){this.eventHandler_ListenerStorage[e]=[]}inUse(e){var t;return!!((t=this.eventHandler_ListenerStorage[e])!=null&&t.length)}has(e,t){var s;return((s=this.eventHandler_ListenerStorage[e])==null?void 0:s.indexOf(t))!==-1}amount(e){var t;return((t=this.eventHandler_ListenerStorage[e])==null?void 0:t.length)||0}};var fe=Object.defineProperty,be=(r,e,t)=>e in r?fe(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,z=(r,e,t)=>(be(r,typeof e!="symbol"?e+"":e,t),t);let ve=class{constructor(e){z(this,"_documents"),z(this,"main"),z(this,"_events"),z(this,"events"),this.main=e,this._documents=[e],this.events=this._events=new we(this),this._events.target=this}forDocuments(e){for(let t=0;t<this._documents.length;t++)e(this._documents[t])}get documents(){return[...this._documents]}registerDocument(e,t){if(this._documents.includes(e))return console.warn("Document registered twice");if(this._documents.push(e),t){let s=this.main.head.children;for(let n=0;n<s.length;n++)switch(s[n].nodeName){case"LINK":if(s[n].rel!=="stylesheet")break;case"STYLE":e.head.appendChild(s[n].cloneNode(!0));break}}this._events.emit("added",e)}deregisterDocument(e){let t=this._documents.indexOf(e);if(t==-1)return console.warn("Document not registered");if(this._documents[t]===this.main)return console.warn("Main document cannot be removed");this._documents.splice(t,1),this._events.emit("removed",e)}};const ye="@chocolatelibui/theme",Se="0.1.0";let W=class Y{constructor(e){this.value=e}get ok(){return!0}get err(){return!1}expect(){return this.value}expectErr(e){throw new Error(e)}get unwrap(){return this.value}unwrapOr(){return this.value}andThen(e){return e(this.value)}orElse(){return this}map(e){return new Y(e(this.value))}mapErr(){return this}get toOptional(){return new C(this.value)}safeUnwrap(){return this.value}};var S,x;let Me=(x=class{constructor(e){y(this,S,void 0);u(this,S,new Error().stack),this.error=e}get valid(){return!1}get ok(){return!1}get err(){return!0}expect(e){throw new Error(e+`
Original `+a(this,S)+`
Expect Error`)}expectErr(){return this.error}get unwrap(){throw new Error(`Tried to unwrap Error
Original `+a(this,S)+`
Unwrap Error`)}unwrapOr(e){return e}andThen(){return this}orElse(e){return e(this.error)}map(){return this}mapErr(e){return new x(e(this.error))}get toOptional(){return new q}get stack(){return a(this,S)}},S=new WeakMap,x);class C{constructor(e){this.value=e}get valid(){return!0}get some(){return!0}get none(){return!1}expect(){return this.value}get unwrap(){return this.value}unwrapOr(){return this.value}andThen(e){return e(this.value)}orElse(){return this}map(e){return new C(e(this.value))}toResult(){return new W(this.value)}}class q{get valid(){return!1}get some(){return!1}get none(){return!0}expect(e){throw new Error(e)}get unwrap(){throw new Error("Tried to unwrap None")}unwrapOr(e){return e}andThen(){return this}orElse(e){return e()}map(){return this}toResult(e){return new Me(e)}}function l(r){return new W(r)}function g(r){return new C(r)}function Q(){return new q}let Ee=class{constructor(e,t,s,n){if(e!==void 0&&(this.min=e),t!==void 0&&(this.max=t),s!==void 0){this.step=s;const i=String(s).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);if(this.decimals=i?Math.max(0,(i[1]?i[1].length:0)-(i[2]?+i[2]:0)):0,n!==void 0){this.start=n;const o=String(n).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);this.decimals=Math.max(this.decimals,o?Math.max(0,(o[1]?o[1].length:0)-(o[2]?+o[2]:0)):0)}}}check(e){if("max"in this&&e>this.max)return e+" is bigger than the limit of "+this.max;if("min"in this&&e<this.min)return e+" is smaller than the limit of "+this.max}limit(e){return this.step&&(this.start?e=parseFloat((Math.round((e-this.start+Number.EPSILON)/this.step)*this.step+this.start).toFixed(this.decimals)):e=parseFloat((Math.round((e+Number.EPSILON)/this.step)*this.step).toFixed(this.decimals))),g(Math.min(this.max??1/0,Math.max(this.min??-1/0,e)))}};var O;class U{constructor(e){y(this,O,void 0);u(this,O,e)}check(e){if(!(e in a(this,O)))return e+" is not in list"}limit(e){return g(e)}}O=new WeakMap;class Te{constructor(){this.subscribers=[]}subscribe(e,t){return this.subscribers.includes(e)?(console.warn("Function already registered as subscriber"),e):(this.subscribers.push(e),t&&this.then(s=>{e(s)}),e)}unsubscribe(e){const t=this.subscribers.indexOf(e);return t!=-1?this.subscribers.splice(t,1):console.warn("Subscriber not found with state",this,e),e}related(){return Q()}inUse(){return!!this.subscribers.length}hasSubscriber(e){return this.subscribers.includes(e)}updateSubscribers(e){for(let t=0,s=this.subscribers.length;t<s;t++)try{this.subscribers[t](e)}catch(n){console.warn("Failed while calling subscribers ",n,this,this.subscribers[t])}}}var d,M,m,E,K;let w=(K=class extends Te{constructor(t,s,n,i){super();y(this,d,void 0);y(this,M,void 0);y(this,m,void 0);y(this,E,void 0);if(s&&u(this,M,s===!0?o=>a(this,m)?a(this,m).limit(o).map(c=>l(c)):g(l(o)):s),n&&u(this,m,n),i&&u(this,E,i),t instanceof Promise)this.then=t.then.bind(t),t.then(o=>{u(this,d,o),delete this.then,delete this.write}),this.write=o=>{t.then(()=>{delete this.write,this.write(o)})};else if(typeof t=="function"){let o=new Promise(c=>{this.then=b=>{let h=t();return this.then=h.then.bind(h),h.then(f=>{u(this,d,f),delete this.then,delete this.write,c()}),h.then(b)}});this.write=c=>{o.then(()=>{delete this.write,this.write(c)})}}else u(this,d,t)}async then(t){return t(a(this,d))}related(){return a(this,E)?a(this,E).call(this):Q()}write(t){a(this,M)&&a(this,d).ok&&a(this,d).value!==t&&a(this,M).call(this,t).map(this.set.bind(this))}check(t){return a(this,m)?a(this,m).check(t):void 0}limit(t){return a(this,m)?a(this,m).limit(t):g(t)}set(t){u(this,d,t),this.updateSubscribers(t)}},d=new WeakMap,M=new WeakMap,m=new WeakMap,E=new WeakMap,K),j=localStorage["settings/packageVersions"],T={};try{T=j?JSON.parse(j):{}}catch{}let A,Le=(r,e,t,s)=>{let n;return T[r]!==e&&(n=T[r],T[r]=e,A&&clearTimeout(A),A=setTimeout(()=>{localStorage["settings/packageVersions"]=JSON.stringify(T)},1e3)),new G(r,t,s,n||void 0)};class _e extends w{constructor(e,t,s,n,i,o){super(e,n,i,o),this.name=t,this.description=s}}class G{constructor(e,t,s,n){this.settings={},this.subGroups={},this.versionChanged=n,this.pathID=e,this.name=t,this.description=s}makeSubGroup(e,t,s){if(e in this.subGroups){console.warn("Sub group already registered "+e);return}return this.subGroups[e]=new G(this.pathID+"/"+e,t,s,this.versionChanged)}addSetting(e,t,s,n,i,o,c,b){if(e in this.settings)throw new Error("Settings already registered "+e);let h=localStorage[this.pathID+"/"+e],f=this.settings[e]=new _e(async()=>{if(h)try{if(this.versionChanged&&b){let F=b(JSON.parse(h),this.versionChanged);return localStorage[this.pathID+"/"+e]=JSON.stringify(F),l(F)}return l(JSON.parse(h))}catch{}let v;return t instanceof Promise?v=await t:typeof t=="function"?v=await t():v=t,localStorage[this.pathID+"/"+e]=JSON.stringify(v),l(v)},s,n,i,o,c);return f.subscribe(v=>{localStorage[this.pathID+"/"+e]=JSON.stringify(v.unwrap)}),f}}let I=(r,e)=>{let t;return function(){return t||(t=new DOMParser().parseFromString(e,"image/svg+xml").firstChild,t.setAttribute("icon",r)),t.cloneNode(!0)}},De=I("material_action_touch_app_rounded",'<svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24" viewBox="0 0 24 24" width="24"><g><rect fill="none" height="24" width="24"/></g><g><g><path d="M18.19,12.44l-3.24-1.62c1.29-1,2.12-2.56,2.12-4.32c0-3.03-2.47-5.5-5.5-5.5s-5.5,2.47-5.5,5.5c0,2.13,1.22,3.98,3,4.89 v3.26c-2.15-0.46-2.02-0.44-2.26-0.44c-0.53,0-1.03,0.21-1.41,0.59L4,16.22l5.09,5.09C9.52,21.75,10.12,22,10.74,22h6.3 c0.98,0,1.81-0.7,1.97-1.67l0.8-4.71C20.03,14.32,19.38,13.04,18.19,12.44z M17.84,15.29L17.04,20h-6.3 c-0.09,0-0.17-0.04-0.24-0.1l-3.68-3.68l4.25,0.89V6.5c0-0.28,0.22-0.5,0.5-0.5c0.28,0,0.5,0.22,0.5,0.5v6h1.76l3.46,1.73 C17.69,14.43,17.91,14.86,17.84,15.29z M8.07,6.5c0-1.93,1.57-3.5,3.5-3.5s3.5,1.57,3.5,3.5c0,0.95-0.38,1.81-1,2.44V6.5 c0-1.38-1.12-2.5-2.5-2.5c-1.38,0-2.5,1.12-2.5,2.5v2.44C8.45,8.31,8.07,7.45,8.07,6.5z"/></g></g></svg>'),xe=I("material_device_dark_mode_rounded",'<svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24" viewBox="0 0 24 24" width="24"><rect fill="none" height="24" width="24"/><path d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"/></svg>'),Oe=I("material_device_light_mode_rounded",'<svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24" viewBox="0 0 24 24" width="24"><rect fill="none" height="24" width="24"/><path d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"/></svg>'),Ie=I("material_hardware_mouse_rounded",'<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M20 9c-.04-4.39-3.6-7.93-8-7.93S4.04 4.61 4 9v6c0 4.42 3.58 8 8 8s8-3.58 8-8V9zm-2 0h-5V3.16c2.81.47 4.96 2.9 5 5.84zm-7-5.84V9H6c.04-2.94 2.19-5.37 5-5.84zM18 15c0 3.31-2.69 6-6 6s-6-2.69-6-6v-4h12v4z"/></svg>'),ke=I("material_image_edit_rounded",'<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M14.06 9.02l.92.92L5.92 19H5v-.92l9.06-9.06M17.66 3c-.25 0-.51.1-.7.29l-1.83 1.83 3.75 3.75 1.83-1.83c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.2-.2-.45-.29-.71-.29zm-3.6 3.19L3 17.25V21h3.75L17.81 9.94l-3.75-3.75z"/></svg>'),p=[],P={};const k=Le(ye,Se,"Theme/UI","Settings for UI elements and and color themes");var N=(r=>(r.Light="light",r.Dark="dark",r))(N||{});const X={light:{name:"Light",description:"Theme optimized for daylight",icon:Oe},dark:{name:"Dark",description:"Theme optimized for night time",icon:xe}},Z=new w(l(X)),ze=new U(X),$=k.addSetting("theme",window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light","Theme","Theme to use for the UI",!0,ze,()=>g({list:Z}));$.subscribe(r=>{p.forEach(e=>{e.applyTheme(r.unwrap)})});const B=$;window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",r=>{$.write(r.matches?"dark":"light")});const Pe=new w(l(400)),Ne=new w(l(50)),He=new w(l(0)),Ce=new w(l("%")),Ue=new Ee(50,400);let H=1;const ee=k.addSetting("scale",100,"Scale","UI scale",!0,Ue,()=>g({min:Ne,max:Pe,unit:Ce,decimals:He}));ee.subscribe(r=>{H=r.unwrap/100,p.forEach(e=>{e.applyScale(H)})});const te=ee,Ve=r=>r*H,Ae=r=>r/H;var L=(r=>(r.THIN="thin",r.MEDIUM="medium",r.WIDE="wide",r))(L||{});const re={thin:{name:"Thin",description:"Thin modern scrollbar"},medium:{name:"Medium",description:"Normal scrollbar"},wide:{name:"Wide",description:"Large touch friendly scrollbar"}},se=new w(l(re)),Be=new U(re),ne=k.addSetting("scrollbar","thin","Scrollbar Mode","Size of the scrollbar to use",!0,Be,()=>g({list:se}));ne.subscribe(r=>{p.forEach(e=>{e.applyScrollbar(r.unwrap)})});const ie=ne;var _=(r=>(r.MOUSE="mouse",r.PEN="pen",r.TOUCH="touch",r))(_||{});const oe={mouse:{name:"Mouse",description:"Mouse input",icon:Ie},pen:{name:"Pen",description:"Pen input",icon:ke},touch:{name:"Touch",description:"Touch input",icon:De}},ae=new w(l(oe)),Ge=new U(oe),le=k.addSetting("input","touch","Input Mode","Setting for preffered input mode, changes UI elements to be more optimized for the selected input mode",!0,Ge,()=>g({list:ae}));le.subscribe(r=>{p.forEach(e=>{e.applyInput(r.unwrap)})});const ce=le;var D=(r=>(r.ALL="all",r.MOST="most",r.SOME="some",r.NONE="none",r))(D||{});const he={all:{name:"All",description:"All animations"},most:{name:"Most",description:"All but the heaviest animations"},some:{name:"Some",description:"Only the lightest animations"},none:{name:"None",description:"No animations"}},ue=new w(l(he)),$e=new U(he),de=k.addSetting("animation","all","Animation Level","Setting for animation level, changes the amount of animations used in the UI",!0,$e,()=>g({list:ue}));de.subscribe(r=>{p.forEach(e=>{e.applyAnimation(r.unwrap)})});const me=de;let Fe=(r,e,t)=>(P[r]=new V(r,e,t),P[r]);class V{constructor(e,t,s){this.variables={},this.subGroups={},this.pathID=e,this.name=t,this.description=s}makeSubGroup(e,t,s){if(e in this.subGroups)throw new Error("Sub group already registered "+e);return this.subGroups[e]=new V(this.pathID+"/"+e,t,s)}makeVariable(e,t,s,n,i,o,c){if(e in this.variables)throw new Error("Settings already registered "+e);let b="--"+this.pathID+"/"+e,h=this.variables[b]={name:t,desc:s,vars:{[N.Light]:n,[N.Dark]:i}};for(let f=0;f<p.length;f++)p[f].applySingleProperty(b,h.vars)}applyThemes(e,t){for(const s in this.variables)e.setProperty(s,this.variables[s].vars[t]);for(const s in this.subGroups)this.subGroups[s].applyThemes(e,t)}}class pe{constructor(e){p.push(this),this._handler=e,this._listener=this._handler.events.on("added",t=>{this.applyAllToDoc(t.data)}),e.forDocuments(t=>{this.applyAllToDoc(t)})}destructor(){this._handler.events.off("added",this._listener);let e=p.indexOf(this);if(e==-1)return console.warn("Theme engine already destructed");p.splice(e,1)}async applyAllToDoc(e){this.applyScrollbarToDoc(e,(await ie).unwrap),this.applyThemeToDoc(e,(await B).unwrap),this.applyInputToDoc(e,(await ce).unwrap),this.applyScaleToDoc(e,(await te).unwrap/100),await new Promise(t=>{setTimeout(t,100)}),this.applyAnimationToDoc(e,(await me).unwrap)}applyScrollbar(e){this._handler.forDocuments(t=>{this.applyScrollbarToDoc(t,e)})}applyScrollbarToDoc(e,t){e.documentElement.style.setProperty("--scrollbar",{[L.THIN]:"0.4rem",[L.MEDIUM]:"1rem",[L.WIDE]:"1.875rem"}[t])}applyAnimation(e){this._handler.forDocuments(t=>{this.applyAnimationToDoc(t,e)})}applyAnimationToDoc(e,t){switch(e.documentElement.classList.remove("anim-all","anim-most","anim-some"),t){case D.ALL:e.documentElement.classList.add("anim-all");case D.MOST:e.documentElement.classList.add("anim-most");case D.SOME:e.documentElement.classList.add("anim-some");break}}applyTheme(e){this._handler.forDocuments(t=>{this.applyThemeToDoc(t,e)})}applyThemeToDoc(e,t){for(const s in P)P[s].applyThemes(e.documentElement.style,t)}applyScale(e){this._handler.forDocuments(t=>{this.applyScaleToDoc(t,e)})}applyScaleToDoc(e,t){e.documentElement.style.fontSize=t*16+"px"}applyInput(e){this._handler.forDocuments(t=>{this.applyInputToDoc(t,e)})}applyInputToDoc(e,t){let s=e.documentElement.style;switch(s.setProperty("--mouse","0"),s.setProperty("--pen","0"),s.setProperty("--touch","0"),e.documentElement.classList.remove("mouse","pen","touch"),t){case _.MOUSE:s.setProperty("--mouse","1"),e.documentElement.classList.add("mouse");break;case _.PEN:s.setProperty("--pen","1"),e.documentElement.classList.add("pen");break;case _.TOUCH:s.setProperty("--touch","1"),e.documentElement.classList.add("touch");break}}async applySingleProperty(e,t){let s=(await B).unwrap;this._handler.forDocuments(n=>{n.documentElement.style.setProperty(e,t[s])})}}const Je=Object.freeze(Object.defineProperty({__proto__:null,AnimationLevels:D,InputModes:_,ScrollbarModes:L,ThemeEngine:pe,Themes:N,VariableGroup:V,animationLevel:me,animationLevels:ue,initVariableRoot:Fe,inputMode:ce,inputModes:ae,pxToRem:Ae,remToPx:Ve,scale:te,scrollBarMode:ie,scrollbarModes:se,theme:B,themes:Z},Symbol.toStringTag,{value:"Module"}));let je=new ve(document);new pe(je);document.body.theme=Je;let R=document.body.appendChild(document.createElement("div"));R.id=R.innerHTML="ScaleBox";
